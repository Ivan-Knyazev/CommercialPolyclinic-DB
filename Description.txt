ОБЪЕКТЫ БД CommercialPolyclinic

+ Представления:
1) получение полной информации по пациенту (и возможность обновления, добавление и удаление данных через это представление)
2) получение полной информации о проведённых приёмах с указанием стоимости, результата, информации о враче и типе услуги
3) получение всех записей на приёмы на сегодняшний день
4) получение среднего рейтинга на основе отзывов по всем врачам (для пользователей и аналитики)
*) получение всех типов услуг


+ Функции:
1) получение очереди по записям к какому-то конкретному врачу на сегодняшний день через вызов представления "получение записей на приёмы на сегодняшний день"
2) получение истории посещения врачей по определённому клиенту
3) получение предстоящих записей к врачам по определённому клиенту
4) получение списка чеков по какому-то врачу
5) получение средней стоимости чека по всем типам услуг (аналитика)
*) получение чеков за определённое время (для бухгалтерии и аналитики)
*) Вычисление возраста пациента
*) получение общеё суммы платежей пациента


+ Процедуры:
1) добавление нового пациента с обработкой контактных данных
2) выписка чека по какому-то приёму с учётом скидки
3) обновление статуса приёма в конце дня (установка статуса "отменён" для тех, кто не пришёл)
4) обновление статуса участия в программе лояльности на "неактивен", если вышел срок действия программы


+ Триггеры:
1) запуск процедуры на выписку чека по изменению статуса приёма на "Завершен" с учётом скидки
2) при написании отзыва - проверка на то, что пациент действительно был у данного врача
3) при создании записи - проверка на запись на одно и то же время к одному и тому же врачу + проверка даты, что запись не в прошлое
4,5) Для добавления и удаления данных через представление 1.
*) предотвращение ввода даты рождения в будущем
*) автодобавление в программу лояльности после 5 чека
